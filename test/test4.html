<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    학번<input id="studentNo" type="text" text="">
    이름<input id="name" type="text" text="">
    학년<select name="grade" id="grade">
        <option value="1">1학년</option>
        <option value="2">2학년</option>
        <option value="3">3학년</option>
    </select>
    전공<input id="major" type="text" text="">
    <button id="btn">추가</button>
    <button id="btn2">보기</button>


    <select name="stu" id="stu" onchange="onchangeFunc()">
        <option value="1" id="">1학년</option>
        <option value="2" id="">2학년</option>
        <option value="3" id="">3학년</option>
    </select>

    <div id="show"></div>

    <script>
        var btn = document.getElementById("btn");
        var stu = 
        [{
            studentNo: 101,
            name: "Son yongwon",
            grade: 1,
            major: "컴퓨터"
        }];

        var titles = ['학번', '이름', '학년', '전공'];
        // btn.addEventListener('click', function)
        btn.onclick = function () 
        {
            var aa =
            {
                studentNo: document.getElementById("studentNo").value,
                name: document.getElementById("name").value,
                grade: document.getElementById("grade").value,
                major: document.getElementById("major").value
            };
            stu.push(aa);
        }

        btn2.onclick = function () 
        {
        var $table = document.createElement("table");
        $table.setAttribute("border", "1");
        $tr = document.createElement('tr');

        for (field of titles) 
        {
            var $th = document.createElement("th");
            var $text = document.createTextNode(field);
            $th.appendChild($text);
            $tr.appendChild($th);
        }
        $table.appendChild($tr);
        // document.getElementById("show").firstChild.remove();
            for (row of stu) 
            {
                $tr = document.createElement('tr');
                for (i in row) 
                {
                    var $td = document.createElement('td');
                    $text = document.createTextNode(row[i]);
                    // console.log(i);
                    $td.appendChild($text);
                    $tr.appendChild($td);
                    $table.appendChild($tr);
                    document.getElementById("show").appendChild($table);
                }
            };
        }

        function onchangeFunc() 
        {
            var $show = document.getElementById("show");
            var child = $show.children.length;
            for (var i = 0; i < child; i++) 
            {
                $show.removeChild($show.firstChild);
            };


            var newAry = stu.map(function (o, i, q) 
            {
                return o;
            });
            var filterAry = newAry.filter(function (o, e, q) 
            {
                return o.grade == document.getElementById("stu").value;
            });
               
            var $table = document.createElement("table");
         $table.setAttribute("border", "1");
         $tr = document.createElement('tr');
            filterAry.forEach(function (o,a,i) 
            {
                $tr = document.createElement('tr');
                for (a in o) 
                {
                    var $th = document.createElement("th");
                    var $text = document.createTextNode(o[a]);
                    $th.appendChild($text);
                    $tr.appendChild($th);
                }
            $table.appendChild($tr);
            $show.appendChild($table);
            });
        }
    </script>
</body>

</html>